<div class="perfil-container">
    <!-- Perfil del Usuario -->
    <mat-card class="perfil-card">
        <div *ngIf="!editando; else formularioEdicion">
            <div class="perfil-header">
                <img class="avatar" [src]="user.picture" alt="Avatar" />
                <div class="perfil-info">
                    <h2>{{ user.name }} {{ user.lastname }}</h2>
                    <p>{{ user.email }}</p>
                    <p>{{ user.phone }}</p>
                    <!-- Si tienes país y rol, agrégalos aquí -->
                    <p *ngIf="user.roles && user.roles.length">Roles: {{ user.roles.join(', ') }}</p>
                </div>
            </div>
            <button mat-flat-button color="primary" (click)="editarPerfil()">Editar perfil</button>
        </div>

        <!-- Formulario de edición -->
        <ng-template #formularioEdicion>
            <mat-form-field appearance="outline" class="full-width">
                <mat-label>Nombre</mat-label>
                <input matInput [(ngModel)]="user.name" />
            </mat-form-field>

            <mat-form-field appearance="outline" class="full-width">
                <mat-label>Email</mat-label>
                <input matInput [(ngModel)]="user.email" />
            </mat-form-field>

            <mat-form-field appearance="outline" class="full-width">
                <mat-label>Teléfono</mat-label>
                <input matInput [(ngModel)]="user.phone" />
            </mat-form-field>

            <button mat-stroked-button class="btn-secundario" (click)="fileInput.click()">Cambiar imagen</button>
            <input #fileInput type="file" accept="image/*" style="display: none" (change)="onFileSelected($event)" />
            <div class="btns-edicion">
                <button mat-flat-button color="primary" (click)="guardarCambios()">Guardar</button>
                <button mat-button color="warn" (click)="cancelarEdicion()">Cancelar</button>
            </div>
        </ng-template>
    </mat-card>

    <!-- Historial de Actividad -->
    <mat-card class="historial-card">
        <h3>Historial de actividad</h3>
        <ul class="historial-lista">
            <li>
                📥 Descargó: Documento A.pdf
                <span class="fecha">Hace 2 días</span>
            </li>
            <li>
                ✏️ Actualizó su perfil
                <span class="fecha">Hace 5 días</span>
            </li>
            <li>
                📥 Descargó: Contrato_2025.docx
                <span class="fecha">Hace 1 semana</span>
            </li>
        </ul>
    </mat-card>
</div>
<header class="header-container">
  <div class="logo-container">
    <!-- Botón hamburguesa con detección mejorada - Visible en móvil y PC -->
    <a (click)="toggleSidebar()" href="#"
       [ngClass]="{
         'sidebar-toggle': isInSiteModule || (!isInPagesAdminModule && !isInPromotorModule && !isInCuentaModule),
         'sidebar-toggle-admin': isInPagesAdminModule,
         'sidebar-toggle-promotor': isInPromotorModule,
         'sidebar-toggle-perfil': isInCuentaModule
       }"
       class="hamburger-menu"
       *ngIf="isInPagesAdminModule || isInPromotorModule || isInCuentaModule"
       style="display: flex;">
      <nb-icon icon="menu-2-outline"></nb-icon>
    </a>
    <!-- Botón hamburguesa para módulo site - Solo móvil -->
    <a (click)="toggleSidebar()" href="#"
       class="hamburger-menu sidebar-toggle"
       *ngIf="isInSiteModule || (!isInPagesAdminModule && !isInPromotorModule && !isInCuentaModule)"
       style="display: none;"
       [style.display]="'flex'">
      <nb-icon icon="menu-2-outline"></nb-icon>
    </a>
    <a [routerLink]="['/site/home']" class="logo-link">
      <img src="../../../../assets/images/LOGOTIPO_OFICIAL.webp" alt="Logo">
    </a>
  </div>

  <nav class="nav-container">
    <a [routerLink]="['/site/home']" routerLinkActive="active">Inicio</a>
    <!-- Menú de Servicios -->
    <div class="dropdown-container" (mouseenter)="openDropdown()" (mouseleave)="closeDropdown()">
      <a href="#" class="dropdown-toggle" (click)="toggleDropdown($event)">Servicios</a>
      <ul class="dropdown-menu" [class.show]="isDropdownOpen">
        <li *ngFor="let item of serviciosMenu[0].children">
          <a [routerLink]="item.link" [queryParams]="item.queryParams" (click)="closeDropdown()">{{ item.title }}</a>
        </li>
      </ul>
    </div>
    <a [routerLink]="['/site/nosotros']" routerLinkActive="active">Nosotros</a>
    <a [routerLink]="['/site/contacto']" routerLinkActive="active">Contacto</a>
  </nav>

  <div class="user-container">
    <button nbButton status="primary" (click)="openCartDialog()">
      <nb-icon icon="shopping-cart-outline"></nb-icon>
      <span *ngIf="cartItemCount > 0">{{ cartItemCount }}</span>
    </button>
    <nb-actions size="small" *ngIf="isAuthenticated$ | async; else guestLinks">
      <nb-action class="user-action" *ngIf="user$ | async as user">
        <nb-user [nbContextMenu]="userMenu" [onlyPicture]="userPictureOnly" [name]="user?.name" [picture]="user?.picture"></nb-user>
      </nb-action>
    </nb-actions>
    <ng-template #guestLinks >
      <a (click)="ruteo('login')" class="btn btn-primary">Login</a>
      <a (click)="ruteo('register')" class="btn btn-secondary">Register</a>
    </ng-template>
  </div>
</header>



<div class="carrousel-container">
  
  <!-- Estado de carga global -->
  <div *ngIf="isLoading" class="global-loading">
    <nb-spinner size="large"></nb-spinner>
    <p>Cargando documentos...</p>
  </div>

  <!-- Estado de error global -->
  <div *ngIf="hasError && !isLoading" class="global-error">
    <nb-icon icon="alert-triangle-outline" status="danger"></nb-icon>
    <p>{{ errorMessage }}</p>
    <button nbButton status="primary" (click)="reloadAllData()">
      <nb-icon icon="refresh-outline"></nb-icon>
      Recargar
    </button>
  </div>

  <!-- Carrousel de documentos recientes -->
  <div class="carrousel" *ngIf="!isLoading && !hasError">
    <div class="carrousel-header">
      <h4 class="title">{{titulos[0].titulo}}</h4>
      <div *ngIf="loadingStates.recientes" class="section-loading">
        <nb-spinner size="small"></nb-spinner>
      </div>
    </div>
    
    <swiper-container 
      *ngIf="resientesList.length > 0; else emptyRecientes"
      class="row" 
      grab-cursor="true" 
      navigation="true"
      slides-per-view="5" 
      space-between="30" 
      coverflow-effect-rotate="0"
      coverflow-effect-stretch="0" 
      coverflow-effect-depth="200" 
      coverflow-effect-modifier="1"
      coverflow-effect-slide-shadows="false" 
      aria-label="Carrusel de elementos añadidos recientemente"
      [breakpoints]="{
        '320': { 'slidesPerView': 1 },
        '640': { 'slidesPerView': 2 },
        '800': { 'slidesPerView': 3 },
        '1024': { 'slidesPerView': 4 },
        '1280': { 'slidesPerView': 5 },
        '1600': { 'slidesPerView': 6 }
      }">
      <swiper-slide class="slide" *ngFor="let item of resientesList" aria-label="{{item.title}}">
        <ngx-card [item]="item"></ngx-card>
      </swiper-slide>
    </swiper-container>
    
    <ng-template #emptyRecientes>
      <div class="empty-carrousel">
        <nb-icon icon="file-text-outline"></nb-icon>
        <p>No hay documentos recientes</p>
      </div>
    </ng-template>
  </div>

  <!-- Carrousel de documentos populares -->
  <div class="carrousel" *ngIf="!isLoading && !hasError">
    <div class="carrousel-header">
      <h4 class="title">{{titulos[1].titulo}}</h4>
      <div *ngIf="loadingStates.populares" class="section-loading">
        <nb-spinner size="small"></nb-spinner>
      </div>
    </div>
    
    <swiper-container 
      *ngIf="popularesList.length > 0; else emptyPopulares"
      class="row" 
      grab-cursor="true" 
      navigation="true"
      slides-per-view="5" 
      space-between="30" 
      coverflow-effect-rotate="0"
      coverflow-effect-stretch="0" 
      coverflow-effect-depth="200" 
      coverflow-effect-modifier="1"
      coverflow-effect-slide-shadows="false" 
      aria-label="Carrusel de elementos más populares"
      [breakpoints]="{
        '320': { 'slidesPerView': 1 },
        '640': { 'slidesPerView': 2 },
        '800': { 'slidesPerView': 3 },
        '1024': { 'slidesPerView': 4 },
        '1280': { 'slidesPerView': 5 },
        '1600': { 'slidesPerView': 6 }
      }">
      <swiper-slide class="slide" *ngFor="let item of popularesList" aria-label="{{item.title}}">
        <ngx-card [item]="item"></ngx-card>
      </swiper-slide>
    </swiper-container>
    
    <ng-template #emptyPopulares>
      <div class="empty-carrousel">
        <nb-icon icon="trending-up-outline"></nb-icon>
        <p>No hay documentos populares</p>
      </div>
    </ng-template>
  </div>

  <!-- Carrousel de documentos vendidos -->
  <div class="carrousel" *ngIf="!isLoading && !hasError">
    <div class="carrousel-header">
      <h4 class="title">{{titulos[2].titulo}}</h4>
      <div *ngIf="loadingStates.vendidos" class="section-loading">
        <nb-spinner size="small"></nb-spinner>
      </div>
    </div>
    
    <swiper-container 
      *ngIf="vendidosList.length > 0; else emptyVendidos"
      class="row" 
      grab-cursor="true" 
      navigation="true"
      slides-per-view="5" 
      space-between="30" 
      coverflow-effect-rotate="0"
      coverflow-effect-stretch="0" 
      coverflow-effect-depth="200" 
      coverflow-effect-modifier="1"
      coverflow-effect-slide-shadows="false" 
      aria-label="Carrusel de elementos más vendidos"
      [breakpoints]="{
        '320': { 'slidesPerView': 1 },
        '640': { 'slidesPerView': 2 },
        '800': { 'slidesPerView': 3 },
        '1024': { 'slidesPerView': 4 },
        '1280': { 'slidesPerView': 5 },
        '1600': { 'slidesPerView': 6 }
      }">
      <swiper-slide class="slide" *ngFor="let item of vendidosList" aria-label="{{item.title}}">
        <ngx-card [item]="item"></ngx-card>
      </swiper-slide>
    </swiper-container>
    
    <ng-template #emptyVendidos>
      <div class="empty-carrousel">
        <nb-icon icon="shopping-cart-outline"></nb-icon>
        <p>No hay documentos vendidos</p>
      </div>
    </ng-template>
  </div>

  <!-- Carrousel de documentos gratis -->
  <div class="carrousel" *ngIf="!isLoading && !hasError">
    <div class="carrousel-header">
      <h4 class="title">{{titulos[3].titulo}}</h4>
      <div *ngIf="loadingStates.gratis" class="section-loading">
        <nb-spinner size="small"></nb-spinner>
      </div>
    </div>
    
    <swiper-container 
      *ngIf="freeList.length > 0; else emptyGratis"
      class="row" 
      grab-cursor="true" 
      navigation="true"
      slides-per-view="5" 
      space-between="30" 
      coverflow-effect-rotate="0"
      coverflow-effect-stretch="0" 
      coverflow-effect-depth="200" 
      coverflow-effect-modifier="1"
      coverflow-effect-slide-shadows="false" 
      aria-label="Carrusel de elementos gratuitos"
      [breakpoints]="{
        '320': { 'slidesPerView': 1 },
        '640': { 'slidesPerView': 2 },
        '800': { 'slidesPerView': 3 },
        '1024': { 'slidesPerView': 4 },
        '1280': { 'slidesPerView': 5 },
        '1600': { 'slidesPerView': 6 }
      }">
      <swiper-slide class="slide" *ngFor="let item of freeList" aria-label="{{item.title}}">
        <ngx-card [item]="item"></ngx-card>
      </swiper-slide>
    </swiper-container>
    
    <ng-template #emptyGratis>
      <div class="empty-carrousel">
        <nb-icon icon="gift-outline"></nb-icon>
        <p>No hay documentos gratuitos</p>
      </div>
    </ng-template>
  </div>

</div>